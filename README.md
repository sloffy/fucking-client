# Мобильное приложение "Учет видеорегистраторов"

Мобильное приложение для управления видеорегистраторами и сотрудниками организации, а также для выдачи и возврата устройств. Поддерживает авторизацию и разграничение прав доступа по ролям (admin и operator).

## Технологии

- **React Native 0.76.5** с **Expo SDK 54** - кроссплатформенная разработка для iOS и Android
- **React Navigation** - навигация между экранами
- **Axios** - HTTP клиент для работы с API
- **AsyncStorage** - локальное хранение токенов и данных пользователя
- **Expo Image Picker** - загрузка фотографий сотрудников

## Установка и запуск

### Предварительные требования

- Node.js (версия 14 или выше)
- npm или yarn
- Expo CLI (`npm install -g expo-cli`)
- Для iOS: Xcode и CocoaPods
- Для Android: Android Studio и Android SDK

### Установка зависимостей

```bash
npm install
```

или

```bash
yarn install
```

### Настройка API

API сервер уже настроен и доступен по адресу: `http://158.160.9.21:5000/api`

Если необходимо изменить URL API, откройте файл `src/config/api.js` и измените значение `API_BASE_URL`.

### Запуск приложения

```bash
# Запуск на всех платформах
npm start

# Запуск на iOS
npm run ios

# Запуск на Android
npm run android

# Запуск в веб-браузере
npm run web
```

После запуска откроется Expo DevTools. Вы можете:
- Отсканировать QR-код в приложении Expo Go на вашем телефоне
- Нажать `i` для запуска в iOS симуляторе
- Нажать `a` для запуска в Android эмуляторе

## Структура проекта

```
├── App.js                      # Главный компонент приложения
├── app.json                    # Конфигурация Expo
├── package.json                # Зависимости проекта
├── src/
│   ├── config/
│   │   └── api.js              # Конфигурация API клиента
│   ├── context/
│   │   └── AuthContext.js      # Контекст авторизации
│   ├── navigation/
│   │   └── AppNavigator.js     # Настройка навигации
│   ├── screens/
│   │   ├── LoginScreen.js      # Экран авторизации
│   │   ├── ProfileScreen.js    # Экран профиля
│   │   ├── VideoRecordersScreen.js      # Список видеорегистраторов
│   │   ├── VideoRecorderDetailScreen.js # Детали видеорегистратора
│   │   ├── VideoRecorderFormScreen.js   # Форма добавления/редактирования
│   │   ├── EmployeesScreen.js          # Список сотрудников
│   │   ├── EmployeeDetailScreen.js      # Детали сотрудника
│   │   ├── EmployeeFormScreen.js        # Форма добавления/редактирования
│   │   ├── IssuesScreen.js              # Выдача/возврат видеорегистраторов
│   │   └── HistoryScreen.js             # История и активные выдачи
│   └── services/
│       ├── authService.js               # Сервис авторизации
│       ├── videoRecorderService.js      # Сервис видеорегистраторов
│       ├── employeeService.js           # Сервис сотрудников
│       └── issueService.js              # Сервис выдачи/возврата
```

## Функциональность

### Авторизация
- Вход в систему по логину и паролю
- Сохранение JWT токена для последующих запросов
- Автоматическая проверка валидности токена при запуске

### Профиль
- Просмотр информации о текущем пользователе
- Для администраторов: регистрация новых пользователей
- Выход из системы

### Видеорегистраторы
- Просмотр списка всех видеорегистраторов
- Поиск по названию, серийному номеру, модели
- Просмотр детальной информации
- Для администраторов:
  - Добавление нового видеорегистратора
  - Редактирование данных
  - Удаление видеорегистратора

### Сотрудники
- Просмотр списка всех сотрудников
- Поиск по ФИО, должности
- Просмотр детальной информации с фото
- Для администраторов:
  - Добавление нового сотрудника
  - Редактирование данных
  - Загрузка/изменение фото
  - Удаление сотрудника

### Выдача и возврат
- Выдача видеорегистратора сотруднику
- Возврат видеорегистратора от сотрудника
- Выбор из списка доступных устройств

### История
- Просмотр активных выдач
- Просмотр полной истории операций
- Фильтрация по:
  - Сотруднику
  - Видеорегистратору
  - Дате (от/до)

## Роли пользователей

### Администратор (admin)
- Полный доступ ко всем функциям
- Управление пользователями
- Управление видеорегистраторами
- Управление сотрудниками
- Просмотр и управление выдачами

### Оператор (operator)
- Выдача и возврат видеорегистраторов
- Просмотр истории и активных выдач
- Просмотр списков видеорегистраторов и сотрудников

## API Endpoints

Приложение ожидает следующие эндпоинты API:

### Авторизация
- `POST /api/auth/login` - вход в систему
- `POST /api/auth/register` - регистрация нового пользователя (только admin)
- `GET /api/auth/me` - получение информации о текущем пользователе

### Видеорегистраторы
- `GET /api/video-recorders` - список всех видеорегистраторов
- `GET /api/video-recorders/:id` - детали видеорегистратора
- `POST /api/video-recorders` - создание видеорегистратора (только admin)
- `PUT /api/video-recorders/:id` - обновление видеорегистратора (только admin)
- `DELETE /api/video-recorders/:id` - удаление видеорегистратора (только admin)

### Сотрудники
- `GET /api/employees` - список всех сотрудников
- `GET /api/employees/:id` - детали сотрудника
- `POST /api/employees` - создание сотрудника (только admin)
- `PUT /api/employees/:id` - обновление сотрудника (только admin)
- `DELETE /api/employees/:id` - удаление сотрудника (только admin)
- `POST /api/employees/:id/photo` - загрузка фото сотрудника (только admin)

### Выдача/Возврат
- `POST /api/issues/issue` - выдача видеорегистратора
- `POST /api/issues/return` - возврат видеорегистратора
- `GET /api/issues/active` - список активных выдач
- `GET /api/issues/history` - история операций

## Безопасность

- JWT токены хранятся в AsyncStorage
- Токен автоматически добавляется к каждому запросу через axios interceptor
- При получении 401 ошибки токен удаляется и пользователь перенаправляется на экран авторизации

## Разработка

### Добавление новых экранов

1. Создайте новый компонент в `src/screens/`
2. Добавьте маршрут в `src/navigation/AppNavigator.js`
3. При необходимости добавьте навигацию из других экранов

### Добавление новых API методов

1. Добавьте метод в соответствующий сервис в `src/services/`
2. Используйте `api` из `src/config/api.js` для выполнения запросов

## Лицензия

Этот проект создан для учебных целей.

